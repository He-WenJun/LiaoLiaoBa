$(document).ready(function(){if($("#serverResponse").val()!=undefined){postList(JSON.parse($("#serverResponse").val()))}});function postList(data){if(data.status!=0){$(".postBox").html("<li style='margin: 3px;' class=\"list-group-item postInfoBox text-center\">"+data.msg+"</li>");return}var postInfo=data.data;for(var i=0;i<postInfo.list.length;i++){var html="<li style='margin: 3px;' class=\"list-group-item postInfoBox\">"+'                <div class="container">'+'                      <div class="row">'+'                            <div class="col-lg-10 col-md-10 text-left">'+'                             <div class="author-thumb"><img style="width:35px; height:35px" src="'+postInfo.list[i].accountVo.headPictureSrc+'"/></div> <a href="/api/user/dispatcher/userInfo/'+postInfo.list[i].accountVo.userId+'" style="color:gray;">'+postInfo.list[i].accountVo.userName+'</a>    <a style="padding-left:50px;" href=\'/api/post/postInfo/dispatcher/'+postInfo.list[i].postVo.postId+"'>"+postInfo.list[i].postVo.postName+"</a>"+"                             </div>";if(postInfo.list[i].postVo.commentCount!=undefined){html+='           <div class="col-lg-2 col-md-2 text-right">'+"                         <span>"+postInfo.list[i].postVo.commentCount+"回复</span>"+"                   </div>"}html+="             </div>";if(postInfo.list[i].fileList!=undefined){html+="            <hr/>"+'                <div class="row">'+'                     <div class="col-lg-12 col-md-12">';for(var j=0;j<postInfo.list[i].fileList.length;j++){html+="<img width='200px' heigth='200px' src='"+postInfo.list[i].fileList[j].src+"' class=\"msgImg img-thumbnail\" onclick='imgDisplay(this)'/>"}html+="                 </div>"+"                    </div>"}html+="                 <hr/>"+'                       <div class="row">'+"<div class='col-lg-12 postInfoBox'>"+"<ul class='info postInfo'>";if(postInfo.list[i].postVo.latestCommentDate!=undefined){html+="<li class='m-auto'><span>"+postInfo.list[i].postVo.latestCommentDate+"回复</span></li>"
}html+='<li class="m-auto"><span>浏览次数：'+postInfo.list[i].postVo.readCount+"</span></li>"+'<li class="m-auto"><span>发帖日期：'+timestampToTime(postInfo.list[i].postVo.enrollDate)+"</span></li>"+"</ul>";$(".postBox").append(html)}var pageHtml='<li class="page-item"><button class="page-link" myPageNumber=\''+postInfo.prePage+"'>上一页</button></li>";for(var i=0;i<postInfo.navigatepageNums.length;i++){if(postInfo.navigatepageNums[i]==postInfo.pageNum){pageHtml=pageHtml+'<li class="page-item active"><button class="page-link" myPageNumber=\''+postInfo.navigatepageNums[i]+"'>"+postInfo.navigatepageNums[i]+"</button></li>";continue}pageHtml=pageHtml+'<li class="page-item"><button class="page-link" myPageNumber=\''+postInfo.navigatepageNums[i]+"'>"+postInfo.navigatepageNums[i]+"</button></li>"}pageHtml=pageHtml+'<li class="page-item"><button class="page-link" myPageNumber=\''+postInfo.nextPage+"'>下一页</button></li>";$(".pageBox").append(pageHtml)}function timestampToTime(timestamp){var date=new Date(timestamp);var Y=date.getFullYear()+"-";var M=(date.getMonth()+1<10?"0"+(date.getMonth()+1):date.getMonth()+1)+"-";var D=date.getDate()+" ";return Y+M+D}$(".searchBtn").click(function(){if($(".searchValue").val()!=""){window.location.replace("/api/post/search/"+$(".searchValue").val()+"/1")}else{if(($(".searchValue2").val()!="")){window.location.replace("/api/post/search/"+$(".searchValue2").val()+"/1")}}});
$(document).ready(function(){$("#sidebar-right-responsive").addClass("hidden");getPrivateMessageList()});$(".privateMessageBox").on("click",".bigPrivateMessage",function(){$(".privateMessageBox ").addClass("open")});$(".privateMessageBox").on("click",".minPrivateMessage",function(){$(".privateMessageBox ").removeClass("open")});$("#messageBox").on("click",".oldMessage",function(){getOldMessage()});$(".privateMessageBox").on("click",".delChar",function(){$.ajax({url:"/api/post/delPrivateMessage",data:{"targetUserId":$(this).attr("myvalue")},type:"post",success:function(data){getPrivateMessageList()}})});$(".minPrivateMessageBox").on("click",".delChar",function(){$.ajax({url:"/api/post/delPrivateMessage",data:{"targetUserId":$(this).attr("myvalue")},type:"post",success:function(data){getPrivateMessageList()}})});$(".fixed-sidebar").on("click",".lastPrivateMessage",function(){$.ajax({url:"/api/post/lastMessage",type:"get",dataType:"json",success:function(data){if(data.status==0){$(".sendMessage").attr("myVaule",data.data);$.ajax({url:"/api/user/getUserInfoList",data:JSON.stringify([data.data]),type:"post",dataType:"json",contentType:"application/json;charset=utf-8",success:function(data){if(data.status!=0){return}$("#messageBox").empty();startIndex=-1;chatTargetUser=data.data[0];$(".chatName").html(chatTargetUser.userName);$(".chatBox").addClass("open-chat");firstOldMessage=0;getOldMessage()}})}}})});var chatTargetUser;var startIndex=-1;$(".privateMessageBox").on("click",".privateMessageUser",function(){$(".sendMessage").attr("myVaule",$(this).attr("myValue"));$.ajax({url:"/api/user/getUserInfoList",data:JSON.stringify([$(this).attr("myValue")]),type:"post",dataType:"json",contentType:"application/json;charset=utf-8",success:function(data){if(data.status!=0){return}$("#messageBox").empty();startIndex=-1;chatTargetUser=data.data[0];$(".chatName").html(chatTargetUser.userName);$(".chatBox").addClass("open-chat");firstOldMessage=0;getOldMessage()}})});$(".minPrivateMessageBox").on("click",".privateMessageUser",function(){$(".sendMessage").attr("myVaule",$(this).attr("myValue"));
$.ajax({url:"/api/user/getUserInfoList",data:JSON.stringify([$(this).attr("myValue")]),type:"post",dataType:"json",contentType:"application/json;charset=utf-8",success:function(data){if(data.status!=0){return}$("#messageBox").empty();startIndex=-1;chatTargetUser=data.data[0];$(".chatName").html(chatTargetUser.userName);$(".chatBox").addClass("open-chat");firstOldMessage=0;getOldMessage()}})});$(".chatBox").on("click",".closeChatBtn",function(){$(".chatBox").removeClass("open-chat")});function getPrivateMessageList(){$(".privateMessageBox").empty();$.ajax({url:"/api/post/getPrivateMessageList",type:"get",dataType:"json",success:function(data){if(data.status!=0){return}var privateMessage=data.data;var minNav='<div class="fixed-sidebar-right sidebar--small" id="sidebar-right">'+'		<div class="mCustomScrollbar" data-mcs-theme="dark">'+'			<ul class="chat-users">';for(var i=0;i<privateMessage.length;i++){minNav+='<li class="inline-items js-chat-open myValue="'+privateMessage[i].userId+'">'+'	<div class="author-thumb">'+'<img alt="author" style="width:35px; height:35px" src="'+privateMessage[i].headPictureSrc+'" class="avatar privateMessageUser" myValue="'+privateMessage[i].userId+'">'+"</div>"+"</li>"}minNav+="</ul>"+"		</div>"+'		<div class="search-friend inline-items">'+'			<a href="#" class="js-sidebar-open bigPrivateMessage">'+'				<svg class="olymp-menu-icon"><use xlink:href="/resources/svg-icons/sprites/icons.svg#olymp-menu-icon"></use></svg>'+"			</a>"+"		</div>"+'		<a href="#" class="olympus-chat inline-items js-chat-open lastPrivateMessage">'+'			<svg class="olymp-chat---messages-icon"><use xlink:href="/resources/svg-icons/sprites/icons.svg#olymp-chat---messages-icon"></use></svg>'+"		</a>"+"	</div>";$(".privateMessageBox").append(minNav);var bigNav='<div class="fixed-sidebar-right sidebar--large" id="sidebar-right-1">'+'		<div class="mCustomScrollbar" data-mcs-theme="dark">'+'			<div class="ui-block-title ui-block-title-small">'+'				<a href="#" class="title">私信列表</a>'+"			</div>"+'			<ul class="chat-users">';
for(var i=0;i<privateMessage.length;i++){bigNav+='		<li class="inline-items js-chat-open myValue="'+privateMessage[i].userId+'">'+'					<div class="author-thumb">'+'						<img alt="author" style="width:35px; height:35px" src="'+privateMessage[i].headPictureSrc+'" class="avatar">'+"						 "+"					</div>"+'					<div class="author-status">'+'						<a class="h6 privateMessageUser author-name" myValue="'+privateMessage[i].userId+'">'+privateMessage[i].userName+"</a>"+'						<span class="status">'+privateMessage[i].accountInfo.introduce+"</span>"+"					</div>"+'					<div class="more"><svg class="olymp-three-dots-icon"><use xlink:href="/resources/svg-icons/sprites/icons.svg#olymp-three-dots-icon"></use></svg>'+'						<ul class="more-icons">'+"							<li>"+'								<svg data-toggle="tooltip" data-placement="top" myValue="'+privateMessage[i].userId+'" data-original-title="删除私信" class="olymp-block-from-chat-icon delChar"><use xlink:href="/resources/svg-icons/sprites/icons.svg#olymp-block-from-chat-icon"></use></svg>'+"							</li>"+"						</ul>"+"					</div>"+"				</li>"}bigNav+="  </ul>"+"		</div>"+'		<div class="search-friend inline-items" style="border-color: white;">'+"		</div>"+'		<a href="#" class="olympus-chat inline-items js-chat-open lastPrivateMessage">'+'			<h6 class="olympus-chat-title">打开上一次私信</h6>'+'			<svg class="olymp-chat---messages-icon"><use xlink:href="/resources/svg-icons/sprites/icons.svg#olymp-chat---messages-icon"></use></svg>'+"		</a>"+"	</div>";$(".privateMessageBox").append(bigNav);$(".minPrivateMessageBox").append(bigNav);$("#sidebar-right-responsive").removeClass("hidden");webSocket_init()}})}function getOldMessage(){$.ajax({url:"/api/post/getOldMessage",type:"post",dataType:"json",data:{"userId":chatTargetUser.userId,"startIndex":startIndex},success:function(data){if(data.status!=0){return}var messageList=data.data;var myHeadImg=$(".myHeadImg").attr("src");startIndex=messageList.index;$(".oldMessage").remove();var html="";if(!messageList.lastMessage){html+='<li class="text-center"><button type="button" class=\'btn btn-secondary btn-sm oldMessage\'>查看历史记录</button></li>'
}for(var i=0;i<messageList.privateMessageList.length;i++){if(messageList.privateMessageList[i].userId==chatTargetUser.userId){html+='           <li class="row" style="padding-top: 20px">'+'						<div class="col-3 col-lg-3" style="padding-right: 0px; margin-right: 0px">'+"						    <img width='45px' height='45px' src=\""+chatTargetUser.headPictureSrc+'"  style="margin-top: 5px; border-radius:50%;" alt="author" class="img-thumbnail">'+"						</div>"+'						<div class="col col-md-7 text-center">'+'							<span class="chat-message-item" style="word-break:normal; width:auto; display:block; white-space:pre-wrap;word-wrap : break-word ;overflow: hidden ; background-color: #f0f4f9; float:left; width: 150px;" class="text-center">'+messageList.privateMessageList[i].message+"</span>"+"						</div>"+"					</li>"+'<li class="row"><div class="mx-auto">'+MDHM(messageList.privateMessageList[i].date)+"<div></li>"}else{html+='           <li class="row" style="padding-top: 20px">'+'						<div class="col col-md-7 col-lg-7 offset-md-2 offset-lg-2 text-center">'+'							<span class="chat-message-item" style="word-break:normal; width:auto; display:block; white-space:pre-wrap;word-wrap : break-word ;overflow: hidden ; background-color: #f0f4f9; float:right; width: 150px;" class="text-center">'+messageList.privateMessageList[i].message+"</span>"+"						</div>"+'						<div class="col-3 col-lg-3" style="padding-left: 0px; margin-left: 0px">'+"						    <img width='45px' height='45px' src=\""+myHeadImg+'"  style="margin-top: 5px; border-radius:50%;" alt="author" class="img-thumbnail">'+"						</div>"+"					</li>"+'<li class="row"><div class="mx-auto">'+MDHM(messageList.privateMessageList[i].date)+"<div></li>"}}$("#messageBox").prepend(html);if(firstOldMessage==0){goBottom()}firstOldMessage=1}})}function goBottom(){var div=document.getElementById("pre-scrollable");div.scrollTop=div.scrollHeight}var sessionId;var webSocket;var firstOldMessage=0;$(".chatBox").on("click",".sendMessage",function(){var html='           <li class="row" style="padding-top: 20px">'+'						<div class="col col-md-7 col-lg-7 offset-md-2 offset-lg-2 text-center">'+'							<span class="chat-message-item" style="word-break:normal; width:auto; display:block; white-space:pre-wrap;word-wrap : break-word ;overflow: hidden ; background-color: #f0f4f9; float:right; width: 150px;" class="text-center">'+$(".message").val()+"</span>"+"						</div>"+'						<div class="col-3 col-lg-3" style="padding-left: 0px; margin-left: 0px">'+"						    <img width='45px' height='45px' src=\""+$(".myHeadImg").attr("src")+'"  style="margin-top: 5px; border-radius:50%;" alt="author" class="img-thumbnail">'+"						</div>"+"					</li>"+'<li class="row"><div class="mx-auto">'+MDHM(Date.parse(new Date()))+"<div></li>";
$("#messageBox").append(html);webSocket.send(JSON.stringify(createMessage($(this).attr("myVaule"),sessionId,$(".message").val())));goBottom();$(".message").val("")});function webSocket_init(){$.ajax({url:"/api/user/getSessionId",type:"get",dataType:"json",success:function(data){if(data.status!=0){return}sessionId=data.data;webSocket=new WebSocket("ws://49.234.121.88:8213/privateMessage/"+data.data);webSocket.onmessage=function(result){var respJson=JSON.parse(result.data);if(respJson.status!=0){$("#messageBox").append('<p style="padding-left:30%;">'+respJson.msg+"</p>");goBottom();return}var html='           <li class="row" style="padding-top: 20px">'+'						<div class="col-3 col-lg-3" style="padding-right: 0px; margin-right: 0px">'+"						    <img width='45px' height='45px' src=\""+chatTargetUser.headPictureSrc+'"  style="margin-top: 5px; border-radius:50%;" alt="author" class="img-thumbnail">'+"						</div>"+'						<div class="col col-md-7 text-center">'+'							<span class="chat-message-item" style="word-break:normal; width:auto; display:block; white-space:pre-wrap;word-wrap : break-word ;overflow: hidden ; background-color: #f0f4f9; float:left; width: 150px;" class="text-center">'+respJson.data.message+"</span>"+"						</div>"+"					</li>"+'<li class="row"><div class="mx-auto">'+MDHM(respJson.data.date)+"<div></li>";$("#messageBox").append(html);goBottom()};webSocket.onerror=function(){alert("私信列表WebSocket连接失败")}}})}function createMessage(targetUserId,sessionId,message){var obj=new Object;obj.targetUserId=targetUserId;obj.sessionId=sessionId;obj.message=message;return obj}function MDHM(timestamp){var date=new Date(timestamp);Y=date.getFullYear()+"-";M=(date.getMonth()+1<10?"0"+(date.getMonth()+1):date.getMonth()+1)+"-";D=date.getDate()+" ";h=date.getHours()+":";m=(date.getMinutes()<10?"0"+(date.getMinutes()):date.getMinutes());s=":"+(date.getSeconds()<10?"0"+(date.getSeconds()):date.getSeconds());return M+D+h+m};
$(document).ready(function(){getMessage()});$(".messageList").on("click",".messageBtn",function(){$.ajax({url:"/api/post/delMessage",dataType:"json",type:"post",data:{"messageIndex":$(this).attr("myIndex")},});if($(this).attr("myTypeId")==1){window.location.replace("/api/post/postInfo/dispatcher/"+$(this).attr("postId"))}else{if($(this).attr("myTypeId")==2){getMessage()}else{if($(this).attr("myTypeId")==3){window.location.replace("/api/post/postInfo/dispatcher/"+$(this).attr("postId"))}}}});function getMessage(){$.ajax({url:"/api/post/getMessage",dataType:"json",type:"get",success:function(data){if(data.status!=0){$(".messageList").html('<li class="text-center"><span>'+data.msg+"</span></li>");return}var messageList=data.data;if(messageList.length>0){$(".messageCount").html(messageList.length);$(".messageCount").removeClass("hidden")}var html="";for(var i=0;i<messageList.length;i++){html+='                <li class="message-unread">'+'								<div class="notification-event">'+'									<span class="h6 notification-friend">'+messageList[i].message+"</span>";if(messageList[i].typeId==1){html+='							<span class="chat-message-item">'+messageList[i].data.content+"</span>"+'									<span class="notification-date"><time class="entry-date updated">'+timestampToTime(messageList[i].date)+"</time></span>"+"								</div>"+'								<span class="notification-icon">'+'									<button class="btn btn-primary messageBtn" style="width: 45px; height: 20px; padding: 0px;" myIndex="'+i+'" myId="'+messageList[i].id+'" myTypeId='+messageList[i].typeId+' pageNumber="'+messageList[i].data.pageNumber+'" postId="'+messageList[i].data.postId+'">去看看</button>'+"								</span>"+"							</li>"}else{if(messageList[i].typeId==2){html+='							<span class="chat-message-item">'+messageList[i].data.postName+"</span>"+'									<span class="notification-date"><time class="entry-date updated">'+timestampToTime(messageList[i].date)+"</time></span>"+"								</div>"+'								<span class="notification-icon">'+'									<button class="btn btn-primary messageBtn" style="width: 45px; height: 20px; padding: 0px;" myIndex="'+i+'" myId="'+messageList[i].id+'" myTypeId='+messageList[i].typeId+">确定</button>"+"								</span>"+"							</li>"
}else{if(messageList[i].typeId==3){html+='							<span class="chat-message-item">'+messageList[i].data.content+"</span>"+'									<span class="notification-date"><time class="entry-date updated">'+timestampToTime(messageList[i].date)+"</time></span>"+"								</div>"+'								<span class="notification-icon">'+'									<button class="btn btn-primary messageBtn" style="width: 45px; height: 20px; padding: 0px;" myIndex="'+i+'" myId="'+messageList[i].id+'" myTypeId='+messageList[i].typeId+' postId="'+messageList[i].data.postId+'">去看看</button>'+"								</span>"+"							</li>"}}}}$(".messageList").html(html)}})}function timestampToTime(timestamp){var date=new Date(timestamp);Y=date.getFullYear()+"-";M=(date.getMonth()+1<10?"0"+(date.getMonth()+1):date.getMonth()+1)+"-";D=date.getDate()+" ";h=date.getHours()+":";m=(date.getMinutes()<10?"0"+(date.getMinutes()):date.getMinutes());s=":"+(date.getSeconds()<10?"0"+(date.getSeconds()):date.getSeconds());return M+D+h+m};
var CRUMINA={};(function($){var $window=$(window),$document=$(document),$body=$("body"),$sidebar=$(".fixed-sidebar"),$preloader=$("#hellopreloader");CRUMINA.preloader=function(){$window.scrollTop(0);setTimeout(function(){$preloader.fadeOut(800)},500);return false};jQuery(".back-to-top").on("click",function(){$("html,body").animate({scrollTop:0},1200);return false});$(document).on("click",".quantity-plus",function(){var val=parseInt($(this).prev("input").val());$(this).prev("input").val(val+1).change();return false});$(document).on("click",".quantity-minus",function(){var val=parseInt($(this).next("input").val());if(val!==1){$(this).next("input").val(val-1).change()}return false});$(function(){var action;$(document).on("touchstart mousedown",".number-spinner button",function(){var btn=$(this);var input=btn.closest(".number-spinner").find("input");btn.closest(".number-spinner").find("button").prop("disabled",false);if(btn.attr("data-dir")=="up"){action=setInterval(function(){if(input.attr("max")==undefined||parseInt(input.val())<parseInt(input.attr("max"))){input.val(parseInt(input.val())+1)}else{btn.prop("disabled",true);clearInterval(action)}},50)}else{action=setInterval(function(){if(input.attr("min")==undefined||parseInt(input.val())>parseInt(input.attr("min"))){input.val(parseInt(input.val())-1)}else{btn.prop("disabled",true);clearInterval(action)}},50)}});$(document).on("touchend mouseup",".number-spinner button",function(){clearInterval(action)})});$('a[data-toggle="tab"]').on("shown.bs.tab",function(e){var target=$(e.target).attr("href");if("#events"===target){$(".fc-state-active").click()}});$(".js-sidebar-open").on("click",function(){var mobileWidthApp=$("body").outerWidth();if(mobileWidthApp<=560){$(this).closest("body").find(".popup-chat-responsive").removeClass("open-chat")}$(this).toggleClass("active");$(this).closest($sidebar).toggleClass("open");return false});$window.keydown(function(eventObject){if(eventObject.which==27&&$sidebar.is(":visible")){$sidebar.removeClass("open")
}});$document.on("click",function(event){if(!$(event.target).closest($sidebar).length&&$sidebar.is(":visible")){$sidebar.removeClass("open")}});var $popup=$(".window-popup");$(".js-open-popup").on("click",function(event){var target_popup=$(this).data("popup-target");var current_popup=$popup.filter(target_popup);var offset=$(this).offset();current_popup.addClass("open");current_popup.css("top",(offset.top-(current_popup.innerHeight()/2)));$body.addClass("overlay-enable");return false});$window.keydown(function(eventObject){if(eventObject.which==27){$popup.removeClass("open");$body.removeClass("overlay-enable");$(".profile-menu").removeClass("expanded-menu");$(".popup-chat-responsive").removeClass("open-chat");$(".profile-settings-responsive").removeClass("open");$(".header-menu").removeClass("open");$(".js-sidebar-open").removeClass("active")}});$document.on("click",function(event){if(!$(event.target).closest($popup).length){$popup.removeClass("open");$body.removeClass("overlay-enable");$(".profile-menu").removeClass("expanded-menu");$(".header-menu").removeClass("open");$(".profile-settings-responsive").removeClass("open")}});$("[data-toggle=tab]").on("click",function(){if($(this).hasClass("active")&&$(this).closest("ul").hasClass("mobile-app-tabs")){$($(this).attr("href")).toggleClass("active");$(this).removeClass("active");return false}});$(".js-close-popup").on("click",function(){$(this).closest($popup).removeClass("open");$body.removeClass("overlay-enable");return false});$(".profile-settings-open").on("click",function(){$(".profile-settings-responsive").toggleClass("open");return false});$(".js-expanded-menu").on("click",function(){$(".header-menu").toggleClass("expanded-menu");return false});$(".js-chat-open").on("click",function(){$(".popup-chat-responsive").toggleClass("open-chat");return false});$(".js-chat-close").on("click",function(){$(".popup-chat-responsive").removeClass("open-chat");return false});$(".js-open-responsive-menu").on("click",function(){$(".header-menu").toggleClass("open");
return false});$(".js-close-responsive-menu").on("click",function(){$(".header-menu").removeClass("open");return false});CRUMINA.CallToActionAnimation=function(){var controller=new ScrollMagic.Controller();new ScrollMagic.Scene({triggerElement:".call-to-action-animation"}).setVelocity(".first-img",{opacity:1,bottom:"0",scale:"1"},1200).triggerHook(1).addTo(controller);new ScrollMagic.Scene({triggerElement:".call-to-action-animation"}).setVelocity(".second-img",{opacity:1,bottom:"50%",right:"40%"},1500).triggerHook(1).addTo(controller)};CRUMINA.ImgScaleAnimation=function(){var controller=new ScrollMagic.Controller();new ScrollMagic.Scene({triggerElement:".img-scale-animation"}).setVelocity(".main-img",{opacity:1,scale:"1"},200).triggerHook(0.3).addTo(controller);new ScrollMagic.Scene({triggerElement:".img-scale-animation"}).setVelocity(".first-img1",{opacity:1,scale:"1"},1200).triggerHook(0.8).addTo(controller);new ScrollMagic.Scene({triggerElement:".img-scale-animation"}).setVelocity(".second-img1",{opacity:1,scale:"1"},1200).triggerHook(1.1).addTo(controller);new ScrollMagic.Scene({triggerElement:".img-scale-animation"}).setVelocity(".third-img1",{opacity:1,scale:"1"},1200).triggerHook(1.4).addTo(controller)};CRUMINA.SubscribeAnimation=function(){var controller=new ScrollMagic.Controller();new ScrollMagic.Scene({triggerElement:".subscribe-animation"}).setVelocity(".plane",{opacity:1,bottom:"auto",top:"-20",left:"50%",scale:"1"},1200).triggerHook(1).addTo(controller)};CRUMINA.PlanerAnimation=function(){var controller=new ScrollMagic.Controller();new ScrollMagic.Scene({triggerElement:".planer-animation"}).setVelocity(".planer",{opacity:1,left:"80%",scale:"1"},2000).triggerHook(0.1).addTo(controller)};CRUMINA.ContactAnimationAnimation=function(){var controller=new ScrollMagic.Controller();new ScrollMagic.Scene({triggerElement:".contact-form-animation"}).setVelocity(".crew",{opacity:1,left:"77%",scale:"1"},1000).triggerHook(0.1).addTo(controller)};CRUMINA.responsive={$profilePanel:null,$desktopContainerPanel:null,$responsiveContainerPanel:null,init:function(){this.$profilePanel=jQuery("#profile-panel");
this.$desktopContainerPanel=jQuery("#desktop-container-panel > .ui-block");this.$responsiveContainerPanel=jQuery("#responsive-container-panel .ui-block");this.update()},mixPanel:function(){if(window.matchMedia("(max-width: 1024px)").matches){this.$responsiveContainerPanel.append(this.$profilePanel)}else{this.$desktopContainerPanel.append(this.$profilePanel)}},update:function(){var _this=this;var resizeTimer=null;var resize=function(){resizeTimer=null;_this.mixPanel()};$(window).on("resize",function(){if(resizeTimer===null){resizeTimer=window.setTimeout(function(){resize()},300)}}).resize()}};$document.ready(function(){CRUMINA.preloader();if($(".call-to-action-animation").length){CRUMINA.CallToActionAnimation()}if($(".img-scale-animation").length){CRUMINA.ImgScaleAnimation()}if($(".subscribe-animation").length){CRUMINA.SubscribeAnimation()}if($(".planer-animation").length){CRUMINA.PlanerAnimation()}if($(".contact-form-animation").length){CRUMINA.ContactAnimationAnimation()}if(typeof $.fn.gifplayer!=="undefined"){$(".gif-play-image").gifplayer()}if(typeof $.fn.mediaelementplayer!=="undefined"){$("#mediaplayer").mediaelementplayer({"features":["prevtrack","playpause","nexttrack","loop","shuffle","current","progress","duration","volume"]})}CRUMINA.responsive.init()})})(jQuery);
$(document).ready(function(){getuserInfo();getMuen()});function navInit(data){var strVar="";strVar+='<div class="fixed-sidebar-left sidebar--small" id="sidebar-left">';strVar+='		<a class="logo">';strVar+='			<div class="img-wrap">';strVar+='				<img src="/resources/img/logo.png" alt="Olympus">';strVar+="			</div>";strVar+="		</a>";strVar+="		<!--缩入的左菜单-->";strVar+='		<div class="mCustomScrollbar data-mcs-theme="dark">';strVar+='			<ul class="left-menu">';strVar+="				<li>";strVar+='					<a href="#" class="js-sidebar-open nav-min">';strVar+='						<svg class="olymp-menu-icon left-menu-icon"  data-toggle="tooltip" data-placement="right"   data-original-title="打开菜单"><use xlink:href="/resources/svg-icons/sprites/icons.svg#olymp-menu-icon"></use></svg>';strVar+="					</a>";strVar+="				</li>";for(var i=0;i<data.length;i++){strVar+="				<li>";if(data[i].menuSonsList==""){strVar+='					<a href="'+data[i].menuParent.resource+'">';strVar+='						<svg class="olymp-menu-icon left-menu-icon"  data-toggle="tooltip" data-placement="right"   data-original-title="'+data[i].menuParent.name+'"><use xlink:href="/resources/svg-icons/sprites/icons.svg#'+data[i].menuParent.icon+'"></use></svg>';strVar+="					</a><p><br/></p>"}else{strVar+='               <button style=\'padding: 14px 0px 14px 25px\' type="button" class="btn popover-options"><a style=\'padding: 0px 0px 25px 0px\' title="'+data[i].menuParent.name+'" data-container="body" data-toggle="popover" data-placement="right" data-content="';strVar+="<ul>";for(var j=0;j<data[i].menuSonsList.length;j++){strVar+="<li><a href='"+data[i].menuSonsList[j].resource+"'>"+data[i].menuSonsList[j].name+"</a></li>"}strVar+='<ul>"><svg class="olymp-newsfeed-icon left-menu-icon" data-toggle="tooltip" data-placement="right"   data-original-title="'+data[i].menuParent.name+'"><use xlink:href="/resources/svg-icons/sprites/icons.svg#'+data[i].menuParent.icon+'"></use></svg></a></button>'}strVar+="				</li>"}strVar+='			</ul><div class="ps__scrollbar-x-rail" style="width: 70px; left: 0px; bottom: 0px;"><div class="ps__scrollbar-x" tabindex="0" style="left: 0px; width: 64px;"></div></div><div class="ps__scrollbar-y-rail" style="top: 0px; right: 0px;"><div class="ps__scrollbar-y" tabindex="0" style="top: 0px; height: 0px;"></div></div>';
strVar+="		</div>";strVar+="	</div>";strVar+='	<div class="fixed-sidebar-left sidebar--large" id="sidebar-left-1">';strVar+='		<a class="logo">';strVar+='			<div class="img-wrap">';strVar+='				<img src="/resources/img/logo.png" alt="Olympus">';strVar+="			</div>";strVar+='			<div class="title-block">';strVar+="			</div>";strVar+="		</a>";strVar+="		<!--弹出菜单-->";strVar+='		<div class="mCustomScrollbar" data-mcs-theme="dark">';strVar+='			<ul class="left-menu">';strVar+="				<li>";strVar+='					<a style=\'padding:5px;padding-left:25px;\' href="#" class="js-sidebar-open nav-big">';strVar+='						<svg class="olymp-close-icon left-menu-icon"><use xlink:href="/resources/svg-icons/sprites/icons.svg#olymp-close-icon"></use></svg>';strVar+='						<span class="left-menu-title">折叠菜单栏</span>';strVar+="					</a>";strVar+="				</li>";for(var i=0;i<data.length;i++){strVar+="				<li>";if(data[i].menuSonsList==""){strVar+="					<a style='padding:15px;padding-left:25px;' href=\""+data[i].menuParent.resource+'">';strVar+='						<svg class="olymp-menu-icon left-menu-icon"  data-toggle="tooltip" data-placement="right"   data-original-title="'+data[i].menuParent.name+'"><use xlink:href="/resources/svg-icons/sprites/icons.svg#'+data[i].menuParent.icon+'"></use></svg>';strVar+="                     <span>"+data[i].menuParent.name+"</span>";strVar+="					</a>"}else{strVar+="					<a style='padding:5px;padding-left:25px;'>";strVar+='						<svg class="olymp-menu-icon left-menu-icon"  data-toggle="tooltip" data-placement="right"   data-original-title="'+data[i].menuParent.name+'"><use xlink:href="/resources/svg-icons/sprites/icons.svg#'+data[i].menuParent.icon+'"></use></svg>';strVar+="                     <span>"+data[i].menuParent.name+"</span>";strVar+="					</a>";strVar+="<ul class='text-center'>";for(var j=0;j<data[i].menuSonsList.length;j++){strVar+="<li>"+"<a href='"+data[i].menuSonsList[j].resource+"'>"+data[i].menuSonsList[j].name+"</a>"+"</li>"}strVar+="</ul>"}strVar+="				</li>"}strVar+="			</ul>";
strVar+="		</div>";strVar+="	</div>";var phoneMenu="";for(var i=0;i<data.length;i++){if(data[i].menuSonsList==""){phoneMenu+="<li><a href='"+data[i].menuParent.resource+"'>"+data[i].menuParent.name+"</a></li>"}else{for(var j=0;j<data[i].menuSonsList.length;j++){phoneMenu+="<li><a href='"+data[i].menuSonsList[j].resource+"'>"+data[i].menuSonsList[j].name+"</a></li>"}}}$(".nav-left").append(strVar);$(".phoneMenu").append(phoneMenu);$(".popover-options a").popover({html:true})}$(".nav-left").on("click",".nav-min",function(){$(".nav-left").addClass("open")});$(".nav-left").on("click",".nav-big",function(){$(".nav-left").removeClass("open")});$("body").on("click",function(e){$('[data-toggle="popover"]').each(function(){if(!$(this).is(e.target)&&$(this).has(e.target).length===0&&$(".popover").has(e.target).length===0){$(this).popover("hide")}})});function getMuen(){$.ajax({url:"/api/user/menu",type:"get",dataType:"json",success:function(data){var strVar="";strVar+='<div class="fixed-sidebar-left sidebar--small" id="sidebar-left">';strVar+='		<a class="logo">';strVar+='			<div class="img-wrap">';strVar+='				<img href="/resources/index.html" src="/resources/img/logo.png" alt="Olympus">';strVar+="			</div>";strVar+="		</a>";strVar+="";strVar+='		<div class="mCustomScrollbar" data-mcs-theme="dark">';strVar+='			<ul class="left-menu">';strVar+='			  <li><a class="nav-link dropdown btn" href='+"/resources/login/index.html"+">"+"登录<br/>注册"+"</a></li>	";strVar+="			</ul>";strVar+="		</div>";strVar+="	</div>";strVar+="";strVar+='	<div class="fixed-sidebar-left sidebar--large" id="sidebar-left-1">';strVar+='		<a class="logo">';strVar+='			<div class="img-wrap">';strVar+='				<img src="img/logo.png" alt="Olympus">';strVar+="			</div>";strVar+='			<div class="title-block">';strVar+='				<h6 class="logo-title">olympus</h6>';strVar+="			</div>";strVar+="		</a>";strVar+="";strVar+='		<div class="mCustomScrollbar" data-mcs-theme="dark">';strVar+='			<ul class="left-menu">';strVar+='			  <li><a class="nav-link dropdown btn" href='+"/resources/login/index.html"+">"+"登录<br/>注册"+"</a></li>	";
strVar+="			</ul>";strVar+="		</div>";strVar+="	</div>";if(data.status==1){$(".nav-left").append(strVar);$(".phoneMenu").append('<li><a class="nav-link dropdown btn" href='+"/resources/login/index.html"+">"+"登录<br/>注册"+"</a></li>")}else{if(data.status==0){navInit(data.data)}else{if(data.status==3){$(".phoneMenu").append('<li><a class="nav-link dropdown btn" href='+"/resources/login/index.html"+">"+"登录<br/>注册"+"</a></li>");$("#nav").append(strVar);$(".modal-body p").html(data.msg);$("#myModal").modal("show")}}}}})}function getuserInfo(){$.ajax({url:"/api/user/userInfo",dataType:"json",type:"get",success:function(data){if(data.status==0){$(".myHeadImg").attr("src",data.data.headPictureSrc);$(".author-title").html(data.data.userName);$(".my_info").removeClass("hidden")}}})}$("header").on("click","#okbtn",function(){$("#myModal").modal("hide");window.location.replace("/resources/login/index.html")});$("#reminderModalOkBtn").click(function(){$(".modal").modal("hide")});
